from matplotlib import pyplot as plt
from sklearn.cluster import AgglomerativeClustering
from sklearn.cluster import KMeans
import numpy as np


# pca=[[120.92317110180261, -58.96610341288265], [83.35575836248098, -32.79699583042346], [542.4606732827197, -823.20111515844], [48.45247177293668, -48.235792881464334], [-260.3612854866333, 76.74710642484581], [78.78363978889915, -71.01950867326316], [249.3228482614811, -142.79111496801286], [-293.4567547342438, 84.00657470893518], [123.00996901833894, -53.39499445772712], [-346.64661172789204, 111.27528442120925], [236.43789405622834, -115.33156637951855], [-208.44028661950824, 60.32561948433871], [-252.83947975848443, 71.410208956175], [-308.1607427999731, 81.48572714252089], [-262.5666501559135, 70.1675102540022], [-308.50753537635546, 100.19542441305224], [1024.163399928864, 1328.9005097701015], [263.09797084309366, -50.364261802549116], [137.88729867461365, -107.50074578310675], [-305.0598975096073, 91.59735521376763], [-284.00895994141854, 78.50189165305412], [142.20414907454557, -40.0319878504659], [65.01699022337688, -119.26435284861574], [241.5283826992077, -27.017108100358477], [134.67722889530606, -36.65442635810507], [-166.14650917864623, 40.100983401698734], [152.50229055290419, -73.5665787398294], [96.41080626831553, -82.88381800976711], [185.03633746714567, -66.74985061119827], [60.294163884524295, -45.61646755814683], [104.16394122645092, -28.071101013211475], [78.52506746249948, -66.72467138158225], [50.84904363446453, -61.222549143340046], [-329.5012056087665, 108.42680908020158], [227.22622112854825, -58.223251691943815], [-309.7735293510272, 83.99866852596116], [73.35771387084205, -45.07617356588904], [248.07577911046752, -156.1986514971616], [391.343731207395, -479.8417092627345], [-257.4390418839206, 76.37189415526751], [-267.5790097613744, 76.50698965919709], [-3.3283236609363236, -23.445305102890625], [172.8692325309449, -8.410604660400235], [-288.8471061635101, 80.4893503804362], [-240.28771218245697, 63.73790070166369], [-319.6716720278603, 102.72399696062637], [204.75510741845827, -35.72621261018274], [-308.92792625290485, 89.45824046603474], [66.28513477551735, -22.25308536526056], [-281.46617634093775, 104.15205894538141]]
# pca=[[-40.22173286972558, -76.21581164084901], [-38.83880627816104, -75.32337169927753], [-85.4406327063232, 168.1945651748484], [-58.089363198879354, 53.2682437262234], [-42.468673385612306, -86.27821033519403], [-55.25749645332258, 12.252493283166615], [-47.47996782129957, -175.11993161091624], [-75.21688026002425, 129.0215728194905], [-75.26567287165417, 151.6139008608043], [-83.79796332462021, 123.2185519818198], [-43.13489223355859, -102.47410885973265], [-60.26582327708617, 8.046938942705708], [-45.478753361855844, -56.55211037619669], [-60.45452989354035, -212.04307603906068], [-52.56072898470935, -81.7975201866584], [-53.12102554306611, -67.22472173819212], [-86.73020873676099, 215.00260077910386], [-48.80314496597425, -153.9916511191642], [-41.172934569048564, -70.09759235030992], [-49.774069116819184, -143.2854187838536], [-42.082432647211846, -69.67302254041309], [-60.02702480373162, 57.350304211230444], [-66.7703534155442, 65.56632614329207], [-53.72203098596648, -92.5804692588835], [-80.67873074146048, 1426.3972380621215], [-57.03972854058712, 0.2551970971933188], [-73.39976034372077, 125.62695745238783], [-49.78661358171071, -68.53441270929082], [-68.7744550714061, 86.5161895405946], [-47.39179000311575, -55.316970475999426], [-44.892752460602665, -56.55606841744108], [-68.19365282666715, 81.72373129197744], [-67.97956212221281, 39.81364355400918], [2792.1930513379093, 28.10172704725282], [-46.05669619019571, -72.11892991414861], [-39.31288873984472, -63.392936282925476], [-41.650599211318095, -67.03217167575819], [-60.20353530702487, -147.4017080053505], [-66.69801474950803, -482.27524354412697], [-45.08042601583888, -86.14008822725327], [-49.13044050494482, -74.22059736070575], [-41.48140210872836, -47.80684503313319], [-47.53814638951592, -76.44899486034932], [-55.91721815935191, -147.56462184571615], [-60.299359198880275, 41.21561575094276], [-72.71186311288027, 140.44175255065412], [-57.453153771725816, -206.42006586587988], [-45.283462561740315, -69.25340847253578], [-65.38179603116961, 62.68619203928815], [-73.68186188926278, 166.82633692020934]]
pca=[[-13.698042107437857, 57.20349280858434], [-8.20214023458472, 47.44090579410433], [-246.397387848161, -217.8632684691742], [-48.704889655420246, -30.634400791439766], [10.926978765417052, 30.551184492733658], [-39.648668892335166, -22.553233517533116], [83.76860099397209, 25.452652074982588], [-85.9865860998027, -70.36948758893242], [-51.18341099478644, -30.67021850204478], [-477.4113805509845, -467.1141201258343], [-12.737028730661699, 54.69701273585419], [-45.908821448920975, -39.52664106130731], [-11.104612907864116, 23.748188936887537], [68.23497369710714, 24.978864134103173], [9.434792237098085, 13.758392550134484], [-6.592220866050756, -3.684806045223876], [-80.98017281265433, -91.7021438382129], [-11.061179117354309, 38.55131827521595], [22.73593638069959, 1238.7195060662523], [64.46441331097479, 105.13520975278728], [-15.105015229401554, 29.24163544035338], [-61.16477841574302, -42.653453031401234], [-54.4652506525013, -37.40079333571873], [23.031781456153656, -1.1058553738171144], [-64.21940186172628, -45.84613696128215], [-56.523435055979796, -33.746329917897064], [-69.33325774791342, -49.528606895886206], [-4.146363829119148, 13.422961285242334], [-57.684394950255445, -34.93432622514689], [-36.481428979625186, 140.0890324998902], [-8.462348519889675, 19.456510071421953], [-53.090906485636026, -34.13950095357349], [-61.321240721962646, -34.819749988804595], [25.10269168707992, 175.0481958687812], [-21.21924453031323, 39.09452182201293], [3.8149666759746816, 9.803227868992785], [-10.77315814513282, 37.30924708846535], [48.320622529651104, 62.77889190089427], [1080.9403150477215, -243.49406846476222], [13.1562270173442, 26.59803446507064], [-10.797261001030428, -0.08245346841158165], [-13.159114575411943, 28.63500982759934], [12.82506199362879, 17.24511139914709], [57.63708380620493, 19.86061559140049], [-46.98590151146267, -29.07757794317741], [-185.43147267598053, -164.14013167058874], [759.5107454016761, -250.55701119983985], [-7.2791839605729844, 19.87843243099868], [-64.44789067404233, -54.61428974144946], [-242.19759920998342, -268.4395500704522]]


color=['red','black']
for i in range(len(pca)):
    plt.scatter(pca[i][0], pca[i][1], color=color[1])
# plt.show()

median=np.median(pca)
dis=[]
pca_=[]
for item in pca:
    dis.append(np.linalg.norm(item-median))
mad=np.median(dis)
for index in range(len(dis)):
    if dis[index]<(2*mad):
        pca_.append(pca[index])


n_pca=np.array(pca_)


for i in range(len(pca_)):
    plt.scatter(pca_[i][0], pca_[i][1], color=color[1])
# plt.scatter(median[0],median[1],color=color[0])



#
# k=4
# model=KMeans(n_clusters=k)
# model.fit(n_pca)
#
# print(model.cluster_centers_)
# plt.scatter(model.cluster_centers_[0][0],model.cluster_centers_[0][1])
# plt.scatter(model.cluster_centers_[1][0],model.cluster_centers_[1][1])
#
# result=model.predict(n_pca)
# print(result)
# plt.show()


#
# clustering=AgglomerativeClustering().fit(n_pca)

cls=AgglomerativeClustering(affinity='euclidean',compute_full_tree='auto',connectivity=None,linkage='ward',
                            memory=None,n_clusters=2).fit(n_pca)

print(cls.labels_)

for point,gp_id in zip(n_pca,cls.labels_):
    plt.scatter(point[0],point[1],s=5,c=color[gp_id],alpha=1)

plt.show()


